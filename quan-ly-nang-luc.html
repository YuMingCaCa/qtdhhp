<!DOCTYPE html>
<html lang="vi">
<head>
    <link rel="icon" type="image/png" href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRjTnSBGofmGpcMY_uEoXhgAB-FeeLjVslu1A&s">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý Năng lực Giảng dạy - ĐHHP</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- SheetJS for Excel file reading -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        /* Simple modal style */
        .modal {
            display: none; position: fixed; z-index: 50;
            left: 0; top: 0; width: 100%; height: 100%;
            overflow: auto; background-color: rgba(0,0,0,0.5);
            -webkit-animation-name: fadeIn; -webkit-animation-duration: 0.4s;
            animation-name: fadeIn; animation-duration: 0.4s
        }
        .modal-content {
            background-color: #fefefe; margin: 10% auto; padding: 24px;
            border: 1px solid #888; width: 90%; max-width: 500px;
            border-radius: 12px; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            -webkit-animation-name: slideIn; -webkit-animation-duration: 0.4s;
            animation-name: slideIn; animation-duration: 0.4s
        }
        @-webkit-keyframes slideIn { from {top: -300px; opacity: 0} to {top: 0; opacity: 1} }
        @keyframes slideIn { from {margin-top: -5%; opacity: 0} to {margin-top: 10%; opacity: 1} }
        @-webkit-keyframes fadeIn { from {opacity: 0} to {opacity: 1} }
        @keyframes fadeIn { from {opacity: 0} to {opacity: 1} }
    </style>
</head>
<body class="p-4 md:p-8 bg-gray-100 font-['Inter',_sans-serif]">

    <!-- Main App Content -->
    <div id="app-content" class="hidden">
        <div class="max-w-4xl mx-auto">
            <!-- Back to modules button -->
            <a href="quan-ly-lao-dong-a.html" class="mb-4 bg-white hover:bg-gray-100 text-gray-800 font-bold py-2 px-4 rounded-lg inline-flex items-center transition-colors no-underline shadow-sm border">
                <i class="fas fa-arrow-left mr-2"></i>
                <span>Quay lại trang Lao động A</span>
            </a>
            
            <div class="bg-white p-6 rounded-2xl shadow-lg">
                <!-- Header -->
                <div class="flex justify-between items-start mb-6">
                    <div class="text-left">
                        <h1 class="text-xl md:text-3xl font-bold text-teal-700">Quản lý Năng lực Giảng dạy</h1>
                        <p class="text-md text-gray-600">Gán các học phần mà giảng viên có thể đảm nhận</p>
                    </div>
                    <button id="open-import-modal-btn" class="bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded-lg shadow-md flex items-center gap-2">
                        <i class="fas fa-file-import"></i> Import Năng lực
                    </button>
                </div>

                <!-- User Info and Logout -->
                <div class="flex justify-between items-center mb-6 border-t border-b py-2">
                    <div>
                        <span class="text-sm text-gray-600">Xin chào, <strong id="user-email" class="text-teal-700"></strong>!</span>
                        <span id="user-role-badge" class="ml-2 text-xs font-semibold px-2.5 py-0.5 rounded-full"></span>
                    </div>
                    <button id="logout-btn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-1 px-3 rounded-lg text-sm">
                        <i class="fas fa-sign-out-alt mr-1"></i>Đăng xuất
                    </button>
                </div>

                <!-- Filters -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <div>
                        <label for="department-select" class="block text-sm font-medium text-gray-700 mb-1">1. Chọn Khoa:</label>
                        <select id="department-select" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-teal-500 focus:border-teal-500"></select>
                    </div>
                    <div>
                        <label for="lecturer-select" class="block text-sm font-medium text-gray-700 mb-1">2. Chọn Giảng viên:</label>
                        <select id="lecturer-select" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-teal-500 focus:border-teal-500" disabled>
                            <option value="">-- Vui lòng chọn khoa trước --</option>
                        </select>
                    </div>
                </div>

                <!-- Main Content: Subjects List -->
                <div id="main-content">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Danh sách Học phần có thể đảm nhận</h2>
                    <div id="subjects-list-container" class="p-4 border-2 border-dashed rounded-lg bg-gray-50 min-h-[200px]">
                        <p id="subjects-placeholder" class="text-center text-gray-500 pt-16">Vui lòng chọn khoa và giảng viên để xem danh sách học phần.</p>
                        <!-- Checkboxes will be populated by JS -->
                    </div>
                    <div class="mt-6 text-right">
                        <button id="save-capabilities-btn" class="bg-teal-600 hover:bg-teal-700 text-white font-bold py-3 px-6 rounded-lg shadow-md flex items-center gap-2 ml-auto" disabled>
                            <i class="fas fa-save"></i> Lưu thay đổi
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Import Capabilities Modal -->
    <div id="import-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="document.getElementById('import-modal').style.display='none'">&times;</span>
            <h3 class="text-xl font-bold mb-4">Import Năng lực Giảng dạy</h3>
            <p class="text-sm text-gray-600 mb-4">Tải lên file Excel để gán hàng loạt các môn học mà giảng viên có thể dạy. File import sẽ ghi đè lên năng lực cũ của các giảng viên có trong file.</p>
            <div class="p-4 border rounded-lg bg-gray-50 space-y-4">
                <div>
                     <label for="import-file-input" class="block text-sm font-medium text-gray-700">Chọn file Excel (.xlsx)</label>
                     <input type="file" id="import-file-input" accept=".xlsx" class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                </div>
                <div class="flex justify-between items-center">
                    <button id="download-template-btn" type="button" class="text-blue-600 hover:underline text-sm"><i class="fas fa-download mr-1"></i> Tải file mẫu</button>
                    <button id="start-import-btn" class="bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded-lg">
                        <i class="fas fa-rocket mr-2"></i>Bắt đầu Import
                    </button>
                </div>
            </div>
             <div id="import-results-container" class="mt-4 hidden">
                <h4 class="font-semibold text-gray-800 mb-2">Kết quả Import:</h4>
                <div id="import-log" class="max-h-60 overflow-y-auto border rounded-md p-3 bg-gray-50 text-sm"></div>
            </div>
        </div>
    </div>

    <!-- Alert Modal -->
    <div id="alert-modal" class="modal">
        <div class="modal-content">
             <h3 id="alert-title" class="text-lg font-bold mb-4">Thông báo</h3>
            <p id="alert-message" class="mb-6"></p>
            <div class="flex justify-end">
                <button id="alert-ok-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg">OK</button>
            </div>
        </div>
    </div>

    <!-- JavaScript File -->
    <script type="module" src="js/quan-ly-nang-luc.js"></script>

</body>
</html>
